<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="UTF-8">
<title>Query Format Tool</title>

<style>
*{box-sizing:border-box}

body{
    margin:0;
    font-family:-apple-system,BlinkMacSystemFont,"SF Pro Text","Helvetica Neue",Arial,sans-serif;
    background:#f2f2f7;
    color:#1d1d1f;
    display:flex;
}

/* ===== Right History Panel ===== */
.history-panel{
    width:280px;
    padding:20px;
    background:rgba(255,255,255,0.7);
    backdrop-filter:blur(20px);
    border-left:1px solid #e5e5ea;
}

.history-title{
    font-weight:600;
    margin-bottom:12px;
    display:flex;
    justify-content:space-between;
    align-items:center;
}

.history-item{
    padding:10px;
    border-radius:10px;
    margin-bottom:8px;
    background:#fff;
    cursor:pointer;
    font-size:13px;
    border:1px solid #e5e5ea;
}
.history-item:hover{
    background:#f2f2f7;
}

/* ===== Main ===== */
.main{flex:1;padding:30px}

.container{
    max-width:900px;
    margin:auto;
    padding:28px;
    border-radius:18px;
    background:rgba(255,255,255,0.7);
    backdrop-filter:blur(20px);
    box-shadow:
        0 10px 30px rgba(0,0,0,0.08),
        inset 0 1px 0 rgba(255,255,255,0.6);
}

h1{margin-top:0;font-size:26px;font-weight:600}
h2{font-size:18px;font-weight:600;margin-top:28px}
p{color:#6e6e73}

textarea{
    width:100%;
    height:180px;
    margin-top:12px;
    padding:14px;
    border-radius:12px;
    border:1px solid #e5e5ea;
    font-size:14px;
    outline:none;
}

.format-select{
    margin:18px 0 24px;
}
.format-select label{
    display:block;
    padding:10px 0;
    font-size:14px;
}

button{
    border:none;
    padding:10px 18px;
    border-radius:10px;
    font-size:14px;
    font-weight:500;
    cursor:pointer;
    background:#0071e3;
    color:#fff;
    margin-right:8px;
}

#copyBtn{
    background:#34c759;
    margin-left:12px;
}

/* ‚≠ê ‡∏õ‡∏∏‡πà‡∏°‡∏•‡πâ‡∏≤‡∏á history */
#clearHistoryBtn{
    background:#ff3b30;
    padding:6px 10px;
    font-size:12px;
}

/* ===== Summary ===== */
.summary-box{
    margin-top:12px;
    padding:18px;
    border-radius:14px;
    background:#fff;
    border:1px solid #e5e5ea;
    font-size:14px;
    line-height:1.8;
    white-space:pre-line;
}
.summary-box strong{
    font-size:20px;
    color:#ff7a00;
    font-weight:700;
}

.output-box{
    margin-top:12px;
    padding:16px;
    border-radius:14px;
    background:#ffffff;
    border:1px solid #e5e5ea;
    font-family:Menlo,Consolas,monospace;
    font-size:13px;
    white-space:pre;
    max-height:500px;
    overflow:auto;
}

.row-head{
    display:flex;
    align-items:center;
    justify-content:space-between;
    margin-top:18px;
}
</style>
</head>

<body>

<div class="main">
<div class="container">

<h1>Query Format Tool</h1>

<p>‡∏ß‡∏≤‡∏á‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£ ‡πÅ‡∏•‡πâ‡∏ß‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ü‡∏≠‡∏£‡πå‡πÅ‡∏°‡∏ï ‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏∞‡∏•‡∏ö‡∏Ñ‡πà‡∏≤‡∏ã‡πâ‡∏≥ ‡∏à‡∏±‡∏î‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå ‡πÅ‡∏•‡∏∞‡∏™‡∏£‡∏∏‡∏õ‡∏ú‡∏•‡πÉ‡∏´‡πâ‡∏ó‡∏±‡∏ô‡∏ó‡∏µ</p>

<textarea id="inputArea"
placeholder="‡∏ß‡∏≤‡∏á‡πÅ‡∏ö‡∏ö 1111,2222,3333 ‡∏´‡∏£‡∏∑‡∏≠

1111
2222
3333"></textarea>

<div class="format-select">
<label><input type="radio" name="format" value="comma" checked> 1000,1002,1003</label>
<label><input type="radio" name="format" value="single"> '1000','1002','1003'</label>
<label><input type="radio" name="format" value="double"> "1000","1002","1003"</label>
</div>

<button onclick="processText()">‡∏õ‡∏£‡∏∞‡∏°‡∏ß‡∏•‡∏ú‡∏•</button>

<h2>‡∏™‡∏£‡∏∏‡∏õ‡∏ú‡∏•</h2>
<div id="summary" class="summary-box"></div>

<div class="row-head">
<h2 style="margin:0;">‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå</h2>
<button id="copyBtn" onclick="copyOutput()">Copy</button>
</div>

<div id="output" class="output-box"></div>

</div>
</div>

<!-- ===== History Right ===== -->
<div class="history-panel">
<div class="history-title">
<span>History</span>
<button id="clearHistoryBtn" onclick="clearHistory()">‡∏•‡πâ‡∏≤‡∏á</button>
</div>
<div id="historyList"></div>
</div>

<script>
function processText() {
    let raw = document.getElementById("inputArea").value.trim();
    if (!raw) {
        document.getElementById("summary").innerText = "‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏ß‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡πà‡∏≠‡∏ô‡∏Ñ‡∏£‡∏±‡∏ö";
        document.getElementById("output").innerText = "";
        return;
    }

    let list = raw
        .split(/[\n,\s]+/)
        .map(x => x.replace(/['"]/g,"").trim())
        .filter(x => x !== "");

    let originalCount = list.length;
    let unique = [...new Set(list)];
    let uniqueCount = unique.length;
    let duplicates = list.filter((item, index) => list.indexOf(item) !== index);
    let removed = [...new Set(duplicates)];

    let format = document.querySelector('input[name="format"]:checked').value;

    let formatted = unique.map(x => {
        if (format === "single") return `'${x}'`;
        if (format === "double") return `"${x}"`;
        return x;
    });

    let maxLen = Math.max(...formatted.map(x => x.length)) + 4;
    let pad = (str) => str + " ".repeat(maxLen - str.length);

    let finalResult = "";
    for (let i = 0; i < formatted.length; i += 7) {
        finalResult += formatted.slice(i, i + 7).map(pad).join("") + "\n";
    }

    let summaryText =
`‡∏™‡∏£‡∏∏‡∏õ‡∏ú‡∏•‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
‚Ä¢ ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î        : <strong>${originalCount}</strong>
‚Ä¢ ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÑ‡∏°‡πà‡∏ã‡πâ‡∏≥         : <strong>${uniqueCount}</strong>
‚Ä¢ ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å‡∏•‡∏ö (‡∏ã‡πâ‡∏≥) : <strong>${originalCount - uniqueCount}</strong>
`;

    if (removed.length) {
        summaryText += `\n‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å‡∏•‡∏ö:\n${removed.join(", ")}`;
    } else {
        summaryText += `\n‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ñ‡πà‡∏≤‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å‡∏•‡∏ö`;
    }

    document.getElementById("summary").innerHTML = summaryText;
    document.getElementById("output").innerText = finalResult.trimEnd();

    saveHistory(raw, finalResult.trimEnd());
}

function copyOutput() {
    let text = document.getElementById("output").innerText.trim();
    if (!text) return;
    let cleaned = text.split(/\s+/).filter(x => x).join(",");
    navigator.clipboard.writeText(cleaned).then(()=>alert("Copy ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à üòé"));
}

/* ===== HISTORY ===== */

function clearHistory(){
    localStorage.removeItem("qft_history");
    renderHistory();
}

function saveHistory(input, output){
    let history = JSON.parse(localStorage.getItem("qft_history")||"[]");

    if(history.length && history[0].input === input){
        return;
    }

    history.unshift({
        time:new Date().toLocaleTimeString(),
        input,
        output
    });

    history = history.slice(0,20);
    localStorage.setItem("qft_history",JSON.stringify(history));
    renderHistory();
}

function renderHistory(){
    let box = document.getElementById("historyList");
    box.innerHTML="";
    let history = JSON.parse(localStorage.getItem("qft_history")||"[]");

    history.forEach((h)=>{
        let div=document.createElement("div");
        div.className="history-item";
        div.innerText=`${h.time} ‚Ä¢ ${h.input.split(/[\n,\s]+/).length} items`;
        div.onclick=()=>{
            document.getElementById("inputArea").value=h.input;
            document.getElementById("output").innerText=h.output;
        };
        box.appendChild(div);
    });
}

renderHistory();
</script>

</body>
</html>